\chapter{Script for collecting system call traces}
\label{app:script}

The following batch script is used to collect system call traces of all apk files in a directory. The script should be run in the same directory.

\lstset{language=bash,basicstyle=1\footnotesize,tabsize=2,breaklines=true}
\lstinputlisting{code/final_run.bat}

\chapter{Code of system call based classifier}
\label{app:code}

The java program given below classifies malware and non-malware apps given the system call traces of training and validation apps. It also calculates various performance metrics. This code is available to download at \underline{https://github.com/devmhd/syscall-dump-aggregator}.

\lstset{language=Java,basicstyle=1\footnotesize,tabsize=2,breaklines=true}

\lstinputlisting[caption=Main.java]{code/Main.java}
\lstinputlisting[caption=FloatPair.java]{code/FloatPair.java}
\lstinputlisting[caption=Graphable.java]{code/Graphable.java}